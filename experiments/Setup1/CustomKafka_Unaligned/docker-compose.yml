version: "3.3"
services:
  socketgenerator:
    configs:
      - source: socketgenerator_conf
        target: "/root/app/application.conf"
    image: "nvankaam/codefeedr_socketgenerator"

      # Filebeat, monitoring on log files to send to the elastic stack
    filebeat:
      image: docker.elastic.co/beats/filebeat:6.3.0
      container_name: filebeat
      links:
        - logstash
        - kibana
      command: filebeat -e -strict.perms=false
      networks:
        - elk
      volumes:
        - type: volume
          source: codefeedr-log-vol
          target: /logdir/
        - type: bind
          source: ./filebeat/filebeat.yml
          target: /usr/share/filebeat/filebeat.yml
    
    
configs:
  socketgenerator_conf:
    file: ./socketgenerator.conf

    
volumes:
  codefeedr-log-vol:
    #If you want to log to an external location, uncomment the external definition below
    #external:
      #name: codefeedr-log-vol